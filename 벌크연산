@Modifying      
@Query("update Member m set m.age = m.age +1 where m.age >= :age")
int bulkAgePlus(@Param("age")int age);


  @Test
    public void bulkUpdate() throws Exception{
        //given
        memberRepository.save(new Member("member1", 10));
        memberRepository.save(new Member("member2", 19));
        memberRepository.save(new Member("member3", 20));
        memberRepository.save(new Member("member4", 21));
        memberRepository.save(new Member("member5", 40));

        //when /bulk를 사용하면 영속성 컨텍스트에 저장되는 것을 건너띄우고 db에 강제로 저장하는 느낌
        int resultCount = memberRepository.bulkAgePlus(20);
        em.flush();
        em.clear(); //이 2개를 통해 영속성 컨텍스트에 남은거 지워줌

        List<Member> result = memberRepository.findByUsername("member5");
        Member member5 = result.get(0);
        //영속성컨테이너에는 member5가 40살로 저장되어 있으나 실제 벌크를 앞에 하여서 41살로 db에 저장되어있음
}
